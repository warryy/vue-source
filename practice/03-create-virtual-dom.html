<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>vue abstract</title>
</head>

<body>
    <div id="root">
        <div class="c1">
            <p title="title1" id="haha1">haha1</p>
            <p title="title1">haha2</p>
        </div>
        <ul>
            <li>这是 li1</li>
            <li>这是 li2</li>
            <li>这是 li3</li>
        </ul>
    </div>
</body>

<script>
    class VNode {
        constructor(tag, data, value, type) {
            this.tag = tag;
            this.data = data;
            this.value = value;
            this.type = type;
            this.children = [];
        }

        appendChild(node) {
            this.children.push(node);
        }
    }

    function getVNode(node) {
        let _nodeType = node.nodeType;
        let _vnode = null;



        if (_nodeType === 3) {
            let _value = node.nodeValue;
            _vnode = new VNode(undefined, undefined, _value, _nodeType);

        } else if (_nodeType === 1) {
            let _tag = node.nodeName.toLowerCase();
            let _data = {};
            let _attrs = node.attributes;

            for (let i = 0, _attrsLen = _attrs.length; i < _attrsLen; ++i) { // attrs[i]：属性节点 {nodeType ==== 2 }
                _data[_attrs[i].nodeName] = _attrs[i].nodeValue;
            }

            _vnode = new VNode(_tag, _data, undefined, _nodeType);
            for (let i = 0, _childrenLen = node.childNodes.length; i < _childrenLen; ++i) {
                _vnode.appendChild(getVNode(node.childNodes[i]));
            }
        }

        return _vnode;
    }

    function parseNode(vnode) {
        let _vnodeType = vnode.type;
        let _node = null;

        if (_vnodeType === 3) {
            _node = document.createTextNode(vnode.value);
        } else if (_vnodeType === 1) {
            _node = document.createElement(vnode.tag);

            let _data = vnode.data;
            Object.keys(_data).forEach(key => {
                _node.setAttribute(key, _data[key]);
            });

            vnode.children.forEach(childvnode => {
                _node.appendChild(parseNode(childvnode));
            });
        }

        return _node;
    }

    let root = document.querySelector('#root');
    let vnode = getVNode(root);
    console.log(vnode)
    console.log(parseNode(vnode))
</script>

</html>